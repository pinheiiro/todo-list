import type { NextPage } from 'next';
import Head from 'next/head';
import { getSession } from "next-auth/react";

import { Post } from '../components/posts';
import { Header } from '../components/posts/header';
import { List } from '../components/posts/list/';

const Posts: NextPage = (props) => {
    console.log(props);
    return (
        <div>
            <Head>
                <title>Posts</title>
                <meta name="description" content="Generated by Gabriel" />
                <link rel="icon" href="" />
            </Head>
            <Header user={props}/>
            <Post/>
            <List/>
        </div>
    )
}

export default Posts;


export async function getServerSideProps({ req }) {
    try {
        const session = await getSession({ req });
        if (!session) {
            return {
                redirect: {
                    destination: '/',
                    permanent: false
                }
            }
        }
        return {
            props: session.user
        }
    } catch(err) {
        return {
            redirect: {
                destination: '/',
                permanent: false
            }
        }
    }
}
  